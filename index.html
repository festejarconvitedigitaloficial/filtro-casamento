<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtro Casamento - Duas Op√ß√µes</title>
    <style>
        body { margin: 0; display: flex; flex-direction: column; align-items: center; background: #222; font-family: sans-serif; }
        h2 { color: white; }
        
        /* Container da c√¢mera */
        #canvas-container {
            position: relative;
            width: 100%;
            max-width: 400px; /* Tamanho estilo celular */
            aspect-ratio: 9/16;
            background: #000;
            overflow: hidden;
            border: 2px solid #fff;
        }

        canvas { width: 100%; height: 100%; object-fit: cover; }

        /* Bot√µes */
        .controls { margin-top: 20px; display: flex; gap: 10px; }
        button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-lil { background-color: #d8bfd8; color: #333; } /* Cor Lil√°s */
        .btn-min { background-color: #333; color: white; border: 1px solid white; } /* Cor Minimalista */
        .btn-foto { background-color: #eebb44; color: black; margin-top: 15px; width: 200px;}
    </style>
</head>
<body>

    <h2>Escolha sua Moldura</h2>

    <div id="canvas-container">
        <canvas id="photoCanvas"></canvas>
    </div>

    <div class="controls">
        <button class="btn-lil" onclick="setFrame(1)">Op√ß√£o Lil√°s</button>
        <button class="btn-min" onclick="setFrame(2)">Op√ß√£o Minimalista</button>
    </div>

    <button class="btn-foto" onclick="downloadPhoto()">üì∏ Baixar Foto</button>

    <script>
        const canvas = document.getElementById('photoCanvas');
        const ctx = canvas.getContext('2d');
        
        // Configura√ß√£o de tamanho (Full HD Vertical)
        canvas.width = 1080;
        canvas.height = 1920;

        let videoStream = null;
        let currentFrame = new Image();
        
        // ---------------------------------------------------------
        // IMPORTANTE: Mude os nomes abaixo para os nomes reais dos seus arquivos
        // Certifique-se que ambos s√£o .png com fundo transparente
        // ---------------------------------------------------------
        const frameSrc1 = 'moldura_lilas.png'; // Nome do arquivo da moldura 1
        const frameSrc2 = 'moldura_minimalista.png'; // Nome do arquivo da moldura 2
        
        // Inicia com a primeira moldura
        currentFrame.src = frameSrc1;

        // 1. Iniciar C√¢mera
        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "user", width: { ideal: 1080 }, height: { ideal: 1920 } } 
                });
                const video = document.createElement('video');
                video.srcObject = stream;
                video.play();
                
                // Loop de desenho (Renderiza√ß√£o)
                function draw() {
                    // Desenha o v√≠deo da c√¢mera (espelhado horizontalmente para parecer espelho)
                    ctx.save();
                    ctx.scale(-1, 1);
                    ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
                    ctx.restore();

                    // Desenha a moldura por cima
                    if (currentFrame.complete) {
                        ctx.drawImage(currentFrame, 0, 0, canvas.width, canvas.height);
                    }
                    
                    requestAnimationFrame(draw);
                }
                draw();
            } catch (err) {
                alert("Erro ao acessar c√¢mera: " + err);
            }
        }

        // 2. Fun√ß√£o para trocar a moldura
        function setFrame(option) {
            if (option === 1) currentFrame.src = frameSrc1;
            if (option === 2) currentFrame.src = frameSrc2;
        }

        // 3. Fun√ß√£o para baixar a foto
        function downloadPhoto() {
            const link = document.createElement('a');
            link.download = 'foto-casamento.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        // Inicia tudo
        startCamera();
    </script>
</body>
</html>
